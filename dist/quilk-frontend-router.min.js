!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):t.QuilkFrontendRouter=r()}(this,function(){var t=function(t,r){var e=this;void 0===r&&(r=!1),this.verbose_mode=r;var n=this.trimEnd(String(window.location.pathname),"/");for(var i in t)if(Array.isArray(t[i]))e.log("Simple numeric array path matching"),e.run_path_matchers(t,n,i);else if("path"===i){e.log('Key hit "path", passing "path" object to the routing matcher');for(var o in t[i])e.run_path_matchers(t[i],n,o)}else"attributes"===i&&(void 0===window.$?alert("To use attribute selection with the QuilkFrontendRouter please ensure you load in jquery to the window object."):(e.log('Key hit "attributes", passing "attributes" object to the routing matcher'),e.run_attribute_matchers(t[i])))};return t.prototype.log=function(t){!0===this.verbose_mode&&console.log("QuilkFrontendRouter message: ",t)},t.prototype.run_attribute_matchers=function(t){var r=this,e=window.$;for(var n in t){var i=t[n],o=n;for(var s in i){var a=i[s];if("*"===s)e("*["+o+"]").length>0&&(r.log('Wildcard hit for attr "'+o+'"'),r.run_attribute_constructors(a));else{var h=s.split(" "),u="";switch(o){case"class":for(var c=0;c<h.length;++c)u+="."+h[c]+", ";break;case"id":for(var p=0;p<h.length;++p)u+="#"+h[p]+", ";break;default:for(var l=0;l<h.length;++l)u+="*["+o+"="+h[l]+"], "}u=u.slice(0,-2),e(u).length>0&&(r.log("Attr + val hit: "+u),r.run_attribute_constructors(a))}}}},t.prototype.run_attribute_constructors=function(t){for(var r=this,e=0;e<t.length;++e)r.start_instance(t[e])},t.prototype.run_path_matchers=function(t,r,e){var n=this;if(this.path_match(r,e))for(var i=0;i<t[e].length;++i)n.start_instance(t[e][i])},t.prototype.start_instance=function(t){if(this.instances_run||(this.instances_run=[]),-1===this.instances_run.indexOf(t)){try{new t}catch(t){console.error(t)}this.instances_run.push(t)}},t.prototype.path_match=function(t,r){var e=this;if("*"===r.slice(-1))return"/"===(r=r.substring(0,r.length-1))&&"/"!==t&&2===t.split("/").length||(!!this.compare(t,r)||0===t.indexOf(r));if(-1===r.indexOf("("))return this.compare(t,r);var n=!1;return this.key_to_paths(r).forEach(function(r){e.compare(t,r)&&(n=!0)}),n},t.prototype.key_to_paths=function(t){var r=this,e=t.split("("),n=[this.trimEnd(e[0],"/")];return e[1].slice(0,-1).split("|").forEach(function(t){n.push(r.trimEnd(e[0]+t,"/"))}),n},t.prototype.compare=function(t,r){if(r=this.trimEnd(r,"/"),-1===r.indexOf(":"))return t===r;r=this.trimEnd(r.split(":")[0],"/");var e=t.split("/");return e.pop(),(t=this.trimEnd(e.join("/"),"/"))===r},t.prototype.trimEnd=function(t,r){return t.substring(t.length-r.length,t.length)===r?t.substring(0,t.length-r.length):t},t});
//# sourceMappingURL=quilk-frontend-router.min.js.map
